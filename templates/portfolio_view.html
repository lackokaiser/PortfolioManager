{% extends "layout.html" %}
{% block title %}
Portfolio Management
{% endblock %}
{% block javascriptfile %}{{ url_for('static', filename='js/portfolio_view.js') }}{% endblock %}
{% block content %}
<div class="container">
    <section class="grid" id="portfolio-view">
        <h1>Portfolio Overview</h1>
        <div id="portfolio-chart" class="chart-container">
            <!-- Chart will be rendered here -->
            <canvas id="myChart"></canvas>
        </div>
    </section>
    <section class="grid" id="stock-picker">
        <h1>Stock Picker</h1>
        <div class="search-container">
            <input list="stock-options" id="stock-search" name="stock-search" placeholder="Enter ticker symbol" />
            <datalist id="stock-options">
                {% for stock in stocks %}
                    <option value="{{ stock.Symbol }}">{{ stock.Name }} ({{ stock.sector }}) ( {{ stock.country }})</option>
                {% endfor %}
            </datalist>
            <button class="styled" id="search-button" type="button" onclick="searchStocks()">Search</button>
        </div>
        <div id="search-results" >
                <table id="search-results-table" class="portfolio-table">
                    <thead>
                        <tr>
                            <th>Ticker</th>
                            <th>Price</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="search-results-body">
                        <!-- Search results will be populated here -->
                    </tbody>
                </table>
            </div>
    </section>
    <section class="grid" id="portfolio-section">
    <h1>My Portfolio</h1>
    <table id="portfolio-table" class="portfolio-table">
        <thead>
            <tr>
                <th>Name</th>
                <th>Ticker</th>
                <th>Value</th>
                <th>Quantity</th>
                <th></th>                
            </tr>
        </thead>
        <tbody id="portfolio-table-body">
            <!-- Data will be loaded here by JavaScript -->
        </tbody>
    </table>
</section>

<!-- Load Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


<!-- Portfolio Performance Section -->
<div style="text-align: left;">
    <section class="grid" id="portfolio-growth-section">
        <h1>Track Your Portfolio Growth</h1>
        <i>This chart shows how the total value of your portfolio has changed over time - based on daily closing price and your total shares</i>
        <br></br>

        <!-- Time Range -->
        <div class="mode-selector">
            <label>Select a time range to view performance:</label><br>

            <input type="radio" id="mode-d" name="mode" value="d">
            <label for="mode-d">Past Day</label><br>

            <input type="radio" id="mode-w" name="mode" value="w">
            <label for="mode-w">Past Week</label><br>

            <input type="radio" id="mode-m" name="mode" value="m">
            <label for="mode-m">Past Month</label><br>

            <input type="radio" id="mode-y" name="mode" value="y">
            <label for="mode-y">Past Year</label><br><br>

            <button class="styled" onclick="loadPortfolioPerformance()">Generate Performance Chart</button>
        </div>

        <!-- Canvas for the chart -->
        <canvas id="portfolioChart" width="600" height="300"></canvas>
    </section>
</div>

{% endblock %}
